<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v4.11.3"><title>Crossterm Shapes</title><link rel="stylesheet" href="/_astro/about.ziih_YEc.css">
<style>html{background-color:#2e3440;font-family:sans-serif;margin:20px}header{background-color:#434c5e;border-radius:25px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}footer{background-color:#434c5e;border-radius:25px}footer a:hover,footer a:focus{background-color:#81a1c1;border-radius:25px}body{margin:0 auto;width:100%;max-width:80ch;padding:1rem;line-height:1.5;color:#d8dee9;background-color:#4c566a;border-radius:25px}.body-content{padding:20px}.body-content ul{margin-left:30px}*{box-sizing:border-box}h1{margin:1rem 0;font-size:2.5rem;color:#d8dee9}ul{list-style:circle}.blog-links a{color:#ebcb8b}.blog-links li{list-style:circle}.hamburger{padding:10px 20px;cursor:pointer}.hamburger .line{display:block;width:30px;height:5px;margin-top:10px;margin-bottom:10px;background-color:#eceff4}.nav-links{width:100%;top:5rem;left:48px;background-color:#a09c96;display:none;margin:0;color:#d8dee9}.nav-links a{display:block;text-align:center;padding:10px 0;text-decoration:none;font-size:1.2rem;font-weight:700;text-transform:uppercase;background-color:#5e81ac;border-radius:25px}.nav-links a:hover,.nav-links a:focus{background-color:#81a1c1;border-radius:25px}.expanded{display:unset}@media screen and (min-width: 636px){.nav-links{margin-left:5em;display:block;position:static;width:auto;background:none}.nav-links a{display:inline-block;padding:15px 20px}.hamburger{display:none}}a[data-astro-cid-yxtifmrq]{padding:.5rem 1rem;color:#fff;background-color:#5e81ac;text-decoration:none;border-radius:25px}footer[data-astro-cid-sz7xmlte]{display:flex;gap:1rem;margin-top:2rem}
</style><script type="module">document.querySelector(".hamburger").addEventListener("click",()=>{document.querySelector(".nav-links").classList.toggle("expanded")});
</script></head> <body> <header> <nav> <div class="hamburger"> <span class="line"></span> <span class="line"></span> <span class="line"></span> </div> <div class="nav-links"> <a href="/">Home</a> <a href="/about/">About</a> <a href="/blog/">Blog</a> </div> </nav> </header> <h1>Crossterm Shapes</h1> <div class="body-content">  <p>Written by Todd</p> <p>Published on: 2022-09-27</p> <h1 id="intro">Intro</h1>
<p>Lately I have been getting back into writing more rust code. One thing that has my interest in Rust is getting back into playing with terminal user interfaces and drawing graphics in a terminal. As a dip back into this after not playing with it in many months, I have written a little program to draw some basic shapes in a terminal instance. I think eventually it would be fun to play around with building on top of making some basic shapes into creating a my own terminal user interface library. However, that can be a bit of a lofty goal. First, start with some basics.</p>
<h1 id="what-we-will-be-using">What we will be using:</h1>
<ul>
<li><a href="https://crates.io/crates/crossterm">Crossterm</a></li>
<li><a href="https://www.rust-lang.org/">Rust</a></li>
<li><a href="https://github.com/martintc/ArticleCode/tree/main/crossterm-shapes">Code used in article</a></li>
</ul>
<h1 id="crossterm">Crossterm</h1>
<p>Crossterm is a multiplatform terminal manipulation library and makes it easy to do some interesting things in the terminal. It provides some nice abstractions so that we don’t have to get too deep in the weeds on terminals, which I have done before in C. That can be fun, but not necessarily when you are just looking to play around. But to give a taste of doing this in a more low level way, you often have to use a series of codes to accomplish tasks such as changing the color of text in a terminal or moving around. These are usually ansi escape codes. And it might look a little something like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">	\u1b[31mtest\033[ming\n</span></span>
<span class="line"></span></code></pre>
<p>For information on something such as color code, I would refer you to take a look at <a href="http://jafrog.com/2013/11/23/colors-in-terminal.html">this</a>.</p>
<p>Luckily, crossterm provides some nice easy ways of dealing with this without all of that.</p>
<h1 id="requirements">Requirements</h1>
<p>The code shown today will be able to accomplish a few things:</p>
<ul>
<li>Take control of the terminal it is being ran in</li>
<li>Enable raw mode</li>
<li>Process key events</li>
<li>Move the cursor to a point</li>
<li>Print a character at a given point</li>
<li>Print out a square</li>
<li>Print out a triangle</li>
</ul>
<h1 id="entry-point">Entry point</h1>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> main</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">-></span><span style="color:#B392F0"> Result</span><span style="color:#E1E4E8">&#x3C;()> {</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#F97583"> mut</span><span style="color:#E1E4E8"> stdout </span><span style="color:#F97583">=</span><span style="color:#B392F0"> stdout</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">ClearType</span><span style="color:#F97583">::</span><span style="color:#B392F0">All</span><span style="color:#E1E4E8">))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> (x, y) </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crossterm</span><span style="color:#F97583">::</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">size</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#B392F0">    enable_raw_mode</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    loop</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        match</span><span style="color:#B392F0"> process_input_events</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#B392F0">            Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Quit</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">		stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">ClearType</span><span style="color:#F97583">::</span><span style="color:#B392F0">All</span><span style="color:#E1E4E8">))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">		break</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">	    },</span></span>
<span class="line"><span style="color:#B392F0">	    Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">		stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">ClearType</span><span style="color:#F97583">::</span><span style="color:#B392F0">All</span><span style="color:#E1E4E8">))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">	    },</span></span>
<span class="line"><span style="color:#B392F0">	    Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Square</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">		print_square</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;mut</span><span style="color:#E1E4E8"> stdout, x, y)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">	    },</span></span>
<span class="line"><span style="color:#B392F0">	    Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Triangle</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">		print_triangle</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;mut</span><span style="color:#E1E4E8"> stdout, x, y)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">	    },</span></span>
<span class="line"><span style="color:#B392F0">            Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">None</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {},</span></span>
<span class="line"><span style="color:#B392F0">            None</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    Ok</span><span style="color:#E1E4E8">(())</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p>First to do is to grab a struct of <code>Stdout.</code> According to the <a href="https://doc.rust-lang.org/std/io/struct.Stdout.html">documentation</a>, this is a handle on the global standard output stream of the current running process. In the case of our program, it is the terminal. We do this in the first like but evoking the <code>stdout()</code> function and setting it equal to a mutable <code>stdout</code> variable. The next thing we may want to do is to clear the terminal of pesky text we don’t want. Crossterm gives us a nice function that can be used on stdout called <a href="https://docs.rs/crossterm/0.25.0/crossterm/trait.ExecutableCommand.html#tymethod.execute">execute</a>. This allows for executing commands on the stdout. We can pass a command provided in <code>terminal</code> called <code>Clear</code>. <a href="https://docs.rs/crossterm/0.25.0/crossterm/terminal/struct.Clear.html">Clear</a> allows the terminal buffer to cleared, however it can take <a href="https://docs.rs/crossterm/0.25.0/crossterm/terminal/enum.ClearType.html">enums that communicate how to clear it</a>. In this case, we want to clear everything, so we can use <code>ClearType::All.</code> However, there are many different ways to clear the terminal. We can clear from cursor down, cursor up, only the current line and a few more options.</p>
<p>Next thing we may want are some bounds on our terminal. We can get this using <a href="https://docs.rs/crossterm/latest/crossterm/terminal/fn.size.html">terminal::size</a>. This will return a tuple that we can unpack into their respective x and y coordinates. It should also be noted that main returns a <code>Result</code> and the <code>?</code> operator pretty much says if an error happens to bubble this up/bail out of the program.</p>
<p>Then, want to enter into <a href="https://docs.rs/crossterm/latest/crossterm/terminal/index.html#raw-mode">raw mode</a>. Reading the documentation, raw mode will set the following modes:</p>
<ul>
<li>Input will not be forwarded to the screen</li>
<li>Input will not be processed on pressing enter</li>
<li>Input will not be line buffered</li>
<li>Special keybindings like Ctl + C will not be processed (we will define our own quit keybinding)</li>
<li>New line characters are not processed, so if we write, we must used <code>write!</code>.</li>
</ul>
<p>Following that is our main loop where we will process some inputs and react based on that. At the end, we return <code>Ok(())</code> if we are exiting successfully.</p>
<h1 id="keybindings">Keybindings</h1>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  enum</span><span style="color:#B392F0"> KeyBinding</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">    None</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#B392F0">    Clear</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#B392F0">    Quit</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#B392F0">    Square</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#B392F0">    Triangle</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p>The enum <code>KeyBinding</code> is a set of conditions we intend to handle. When the input process stage happens, it will try to gather input. Depending on this input, input processing will return an enum for the operation to conduct. The operations are fairly straigh forward. <code>None</code> is returned if there was no input to process. <code>Clear</code> will clear the terminal screen. <code>Quit</code> is how from the terminal we communicate that we are quitting. <code>Square</code> and <code>Trianglel</code> to draw those respective shapes on the terminal.</p>
<h1 id="processing-input">Processing Input</h1>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> process_input_events</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">-></span><span style="color:#B392F0"> Option</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">KeyBinding</span><span style="color:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> let</span><span style="color:#B392F0"> Event</span><span style="color:#F97583">::</span><span style="color:#B392F0">Key</span><span style="color:#E1E4E8">(event) </span><span style="color:#F97583">=</span><span style="color:#B392F0"> event</span><span style="color:#F97583">::</span><span style="color:#B392F0">read</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">.</span><span style="color:#B392F0">expect</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Reading key event failed"</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        match</span><span style="color:#E1E4E8"> event {</span></span>
<span class="line"><span style="color:#B392F0">        KeyEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">            code</span><span style="color:#F97583">:</span><span style="color:#B392F0"> KeyCode</span><span style="color:#F97583">::</span><span style="color:#B392F0">Char</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'q'</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">            modifiers</span><span style="color:#F97583">:</span><span style="color:#B392F0"> event</span><span style="color:#F97583">::</span><span style="color:#B392F0">KeyModifiers</span><span style="color:#F97583">::</span><span style="color:#79B8FF">CONTROL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            ..</span></span>
<span class="line"><span style="color:#E1E4E8">	    } </span><span style="color:#F97583">=></span><span style="color:#B392F0"> Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Quit</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#B392F0">	    KeyEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">			code</span><span style="color:#F97583">:</span><span style="color:#B392F0"> KeyCode</span><span style="color:#F97583">::</span><span style="color:#B392F0">Char</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#F97583">			..</span></span>
<span class="line"><span style="color:#E1E4E8">	    } </span><span style="color:#F97583">=></span><span style="color:#B392F0"> Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Square</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#B392F0">	    KeyEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">			code</span><span style="color:#F97583">:</span><span style="color:#B392F0"> KeyCode</span><span style="color:#F97583">::</span><span style="color:#B392F0">Char</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'t'</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#F97583">			..</span></span>
<span class="line"><span style="color:#E1E4E8">	    } </span><span style="color:#F97583">=></span><span style="color:#B392F0"> Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Triangle</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#B392F0">		KeyEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">			code</span><span style="color:#F97583">:</span><span style="color:#B392F0"> KeyCode</span><span style="color:#F97583">::</span><span style="color:#B392F0">Char</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'c'</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#F97583">			..</span></span>
<span class="line"><span style="color:#E1E4E8">	    } </span><span style="color:#F97583">=></span><span style="color:#B392F0"> Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">		_ </span><span style="color:#F97583">=></span><span style="color:#B392F0"> Some</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">KeyBinding</span><span style="color:#F97583">::</span><span style="color:#B392F0">None</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#B392F0"> None</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p>Here is the meat of input processing. Using <a href="https://docs.rs/crossterm/latest/crossterm/event/enum.Event.html">Event</a> and <a href="https://docs.rs/crossterm/latest/crossterm/event/index.html">event</a>. <code>Event</code> is an enum with <code>Key</code> being the enum for key events. <code>Key</code> contains a <a href="https://docs.rs/crossterm/latest/crossterm/event/struct.KeyEvent.html">KeyEvent</a>. To get this, <code>event::read()</code> is called to read any events in the queue. Afterwards, matching on the type of <code>KeyEvent</code>. <code>KeyEvent</code> is a struct with several data members, a <code>KeyCode</code>, <code>KeyModifier</code>, <code>KeyEventKind</code>, and <code>KeyEventState</code>. We only need two here. So, match on the KeyEvent with the specific <em>codes</em> (of type KeyCode) and <em>modifiers</em> (of type KeyModifiers). The assignments are as follows:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>     | KeyEvent | Key binding |</span></span>
<span class="line"><span>     |:---------|:------------|</span></span>
<span class="line"><span>     | Quit     | Ctrl + q    |</span></span>
<span class="line"><span>     | Square   | s           |</span></span>
<span class="line"><span>     | Triangle | t           |</span></span>
<span class="line"><span>     | Clear    | c           |</span></span>
<span class="line"><span></span></span></code></pre>
<p>In all other events, return a <code>None</code> Keybinding.</p>
<h1 id="moving-and-printing-points">Moving and printing points</h1>
<p>For this program, points will be printed using an asterik (*). But, before printing shapes, the cursor must be moved. This is handled in the following function.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">mut</span><span style="color:#E1E4E8"> stdout</span><span style="color:#F97583">:</span><span style="color:#F97583"> &#x26;</span><span style="color:#B392F0">Stdout</span><span style="color:#E1E4E8">, x</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">, y</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">-></span><span style="color:#B392F0"> Result</span><span style="color:#E1E4E8">&#x3C;()> {</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">crossterm</span><span style="color:#F97583">::</span><span style="color:#B392F0">cursor</span><span style="color:#F97583">::</span><span style="color:#B392F0">MoveToRow</span><span style="color:#E1E4E8">(y))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">crossterm</span><span style="color:#F97583">::</span><span style="color:#B392F0">cursor</span><span style="color:#F97583">::</span><span style="color:#B392F0">MoveToColumn</span><span style="color:#E1E4E8">(x))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    Ok</span><span style="color:#E1E4E8">(())</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p>Calling execute on <code>stdout</code> using the <a href="https://docs.rs/crossterm/latest/crossterm/cursor/index.html">crossterm::cursor functions</a>. This will allow a y and x to be passed in and the cursor will move to that location.</p>
<p>The following function will be called to print a point.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">mut</span><span style="color:#E1E4E8"> stdout</span><span style="color:#F97583">:</span><span style="color:#F97583"> &#x26;</span><span style="color:#B392F0">Stdout</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">-></span><span style="color:#B392F0">  Result</span><span style="color:#E1E4E8">&#x3C;()> {</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">crossterm</span><span style="color:#F97583">::</span><span style="color:#B392F0">style</span><span style="color:#F97583">::</span><span style="color:#B392F0">Print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"*"</span><span style="color:#F97583">.</span><span style="color:#B392F0">blue</span><span style="color:#E1E4E8">()))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    Ok</span><span style="color:#E1E4E8">(())</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p><a href="https://docs.rs/crossterm/latest/crossterm/style/struct.Print.html">Print</a> is located in <code>crossterm::style</code> and allows for some simple and useful functionality. It will take an argument that implements <code>Display</code> and functions can be called on that to add some extra features like <code>.blue()</code> will take whatever is being printed and print it out as blue.</p>
<h1 id="drawing-shapes">Drawing shapes</h1>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> print_square</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">mut</span><span style="color:#E1E4E8"> stdout</span><span style="color:#F97583">:</span><span style="color:#F97583"> &#x26;</span><span style="color:#B392F0">Stdout</span><span style="color:#E1E4E8">, x</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">, y</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">-></span><span style="color:#B392F0"> Result</span><span style="color:#E1E4E8">&#x3C;()> {</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">ClearType</span><span style="color:#F97583">::</span><span style="color:#B392F0">All</span><span style="color:#E1E4E8">))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> x_0 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> x_1 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x_0 </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 3</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> y_0 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> y </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 4</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> y_1 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> y_0 </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 3</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    	for</span><span style="color:#E1E4E8"> j </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> x_0</span><span style="color:#F97583">..</span><span style="color:#E1E4E8">x_1 {</span></span>
<span class="line"><span style="color:#F97583">	    for</span><span style="color:#E1E4E8"> k </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> y_0</span><span style="color:#F97583">..</span><span style="color:#E1E4E8">y_1 {</span></span>
<span class="line"><span style="color:#B392F0">	    	move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout, j, y_0)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout, j, y_1)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout, x_0, k)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout, x_1, k)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">	    	print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">		}</span></span>
<span class="line"><span style="color:#E1E4E8">    	}</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#B392F0">    Ok</span><span style="color:#E1E4E8">(())</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  fn</span><span style="color:#B392F0"> print_triangle</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">mut</span><span style="color:#E1E4E8"> stdout</span><span style="color:#F97583">:</span><span style="color:#F97583"> &#x26;</span><span style="color:#B392F0">Stdout</span><span style="color:#E1E4E8">, x</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">, y</span><span style="color:#F97583">:</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">-></span><span style="color:#B392F0"> Result</span><span style="color:#E1E4E8">&#x3C;()> {</span></span>
<span class="line"><span style="color:#E1E4E8">    stdout</span><span style="color:#F97583">.</span><span style="color:#B392F0">execute</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">Clear</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">terminal</span><span style="color:#F97583">::</span><span style="color:#B392F0">ClearType</span><span style="color:#F97583">::</span><span style="color:#B392F0">All</span><span style="color:#E1E4E8">))</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // let x_0 = x / 3;</span></span>
<span class="line"><span style="color:#6A737D">    // let x_1 = x_0 * 2;</span></span>
<span class="line"><span style="color:#6A737D">    // let y_0 = y / 3;</span></span>
<span class="line"><span style="color:#6A737D">    // let y_1 = y_0 * 2;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // for j in x_0..x_1 {</span></span>
<span class="line"><span style="color:#6A737D">    // 	for k in y_0..y_1 {</span></span>
<span class="line"><span style="color:#6A737D">    // 	    move_to_position(&#x26;stdout, j, y_1)?;</span></span>
<span class="line"><span style="color:#6A737D">    // 	    print_point(&#x26;stdout)?;</span></span>
<span class="line"><span style="color:#6A737D">    // 	    move_to_position(&#x26;stdout, x_0, k)?;</span></span>
<span class="line"><span style="color:#6A737D">    // 	    print_point(&#x26;stdout)?;</span></span>
<span class="line"><span style="color:#6A737D">    // 	}</span></span>
<span class="line"><span style="color:#6A737D">    // }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    let</span><span style="color:#F97583"> mut</span><span style="color:#E1E4E8"> array </span><span style="color:#F97583">=</span><span style="color:#B392F0"> vec!</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">vec!</span><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">; x</span><span style="color:#F97583">.</span><span style="color:#B392F0">into</span><span style="color:#E1E4E8">()]; y</span><span style="color:#F97583">.</span><span style="color:#B392F0">into</span><span style="color:#E1E4E8">()];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">13</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">14</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">13</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    array[</span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> (i, row) </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> array</span><span style="color:#F97583">.</span><span style="color:#B392F0">iter</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">.</span><span style="color:#B392F0">enumerate</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">	for</span><span style="color:#E1E4E8"> (j, _col) </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> row</span><span style="color:#F97583">.</span><span style="color:#B392F0">iter</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">.</span><span style="color:#B392F0">enumerate</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">	    if</span><span style="color:#E1E4E8"> array[i][j] </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">		move_to_position</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout, i </span><span style="color:#F97583">as</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">, j </span><span style="color:#F97583">as</span><span style="color:#B392F0"> u16</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">		print_point</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">&#x26;</span><span style="color:#E1E4E8">stdout)</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">	    }</span></span>
<span class="line"><span style="color:#E1E4E8">	}</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#B392F0">    Ok</span><span style="color:#E1E4E8">(())</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre>
<p>These functions will print the shapes respectively. I demonstrated two different ways. The square is a little algorithm that traces out a square based on the bounds provided with the sides computed. The triangle is a little more manual and demonstates how a 2-D array (vectors in Rust’s specific case) can be used to draw to the screen. If one wanted to maybe make some more complicated drawing, some functionality could be built in to read in a text file with a shape drawn in it and use that as a base for what to draw.</p>  </div> <footer data-astro-cid-sz7xmlte> <a href="https://www.github.com/martintc" data-astro-cid-yxtifmrq>github</a>  </footer>  </body> </html>